---
title: "HW5 Solution"
author: "Rong Fan"
date: "February 3, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{exercise}
Exercise 3.14 Let *subset.iris <- as.matrix(iris[1:10, 1:4])*, Using apply function to calculate the mean of *subset.iris* by column.
```{r}
subset.iris <- as.matrix(iris[1:10, 1:4])
apply(subset.iris,2,mean)
```

```{exercise}
Exercise 3.15 Let *subset.iris.2 <- as.matrix(iris[, 1:4])*, fill blanks in the *find.max* function defined below to find the maximal value in each column of *subset.iris.2*.
```{r}
subset.iris.2 <- as.matrix(iris[, 1:4])
find.max <- function(x){       
  y <- function(xcol){       
    return(max(xcol))       
  }         
  return(apply(x,2,y))        
}         

find.max(subset.iris.2) 

```

```{exercise}
Exercise 3.16 Using the *mosaic.plot()* function to blur the image of mona_lisa.pgm by adding mosaic to her eyes region. Your output should look like the graph below.

```{r}
mosaic.plot <- function(image,yrange,xrange){
  length.y <- length(yrange)
  length.x <- length(xrange)
  image2 <- image
  whitenoise <- matrix(nrow=length.y, ncol=length.x, runif(length.y*length.x))
  image2@grey[yrange,xrange] <- whitenoise
  return(image2)
}
```

```{r}
library(pixmap)
mona.lisa <- read.pnm("mona_lisa.pgm", cellres=1)
mona.lisa.mosaic <- mosaic.plot(mona.lisa, 60:85, 81:150)
plot(mona.lisa.mosaic)
```

```{exercise}
Exercise 3.17

Fill in blanks of the following function so that the eyes region of Mona Lisa is covered by pure color, not mosaic. 

```{r}
mosaic.plot.2 <- function(picture,yrange,xrange,degree){          
  length.y <- length(yrange)          
  length.x <- length(xrange)          
  pic2 <- picture          
  pic2@grey[yrange,xrange] <- degree          
  return(pic2)          
}
```

```{r}
library(pixmap)
mona.lisa <- read.pnm("mona_lisa.pgm", cellres=1)
mona.lisa.mosaic <- mosaic.plot.2(mona.lisa, 60:85, 81:150,0)
plot(mona.lisa.mosaic)
```

```{r}
mona.lisa.mosaic <- mosaic.plot.2(mona.lisa, 60:85, 81:150,0.5)
plot(mona.lisa.mosaic)
```
```{r}
mona.lisa.mosaic <- mosaic.plot.2(mona.lisa, 60:85, 81:150,1)
plot(mona.lisa.mosaic)
```

